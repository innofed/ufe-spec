# 接口文档规范

## 简介

该文档主要的设计目标是规范项目的接口文档撰写格式的**规范性和一致性**。

## 约定

+ **[应该]** 采用RESTful的接口风格；
+ **[应该]** 采用JSON格式传递数据。

## 命名规则

* 接口 **[应该]** 按照业务模块来组织，每一个业务模块单独列一个接口文档，使用`index`来组织导航，如：`api/index.md`、`api/biz1.md`、`api/biz2.md`。如果接口不多，可以统一写在`api/index.md`中；
* URL、参数、返回值中的单词 **[应该]** 采取**小写**，复合词采取**下划线**分开的**全小写命名**；
* 将接口的版本号放在URL中，比如：`//ip:<port>/v1/user/1`。

## 元素

接口文档中每一个接口 **[应该]** 包含如下元素：

* 接口名称
* 接口描述
* URL，注意只写相对URL
* 请求方法：`GET` / `POST` / `PUT` / `DELETE`
* 参数列表，包含：
  * 参数名称
  * 参数类型
  * 是否必须
  * 默认值
  * 参数描述，包含含义介绍、规格和约束等 
* 返回值示例，给出典型的返回值举例
* 返回值字段说明，包含：
  * 字段名称
  * 字段类型
  * 字段描述

注意：如果某个参数或者返回字段格式为对象，包含子字段，可以在描述栏中或参数列表下方进一步描述。


## 常见参数约定

一些常见的参数命名及含义如下：

* `token`: 加密标识；
* `page`：从第几页开始，用于分页；
* `per_page`：每一页记录数量，用于分页；
* `limit`：指定返回记录数量；
* `offset`：指定返回记录的开始位置；
* `sortby`：指定排序字段；
* `order`： 指定排序方式：`asc`-正序，`desc`-逆序；


## 返回值格式约定

返回值 **[应该]** 采用`JSON`格式，`JSON`格式可以使用[在线编辑器](https://www.jsoneditoronline.org/)。

返回值 **[应该]** 符合以下规范：

* `GET`: `/collection`：返回资源对象的列表（数组）
* `GET`: `/collection/resource`：返回单个资源对象
* `POST`: `/collection`：返回新生成的资源对象
* `PUT`: `/collection/resource`：返回完整的资源对象
* `DELETE`: `/collection/resource`：返回一个空文档

返回值 **[必须]** 包含如下字段：

* `success`: `类型 boolean`。请求是否成功。正常返回，值为`true`；发生错误，值为`false`
* `error`: `类型 object`。错误信息。如果发生错误，`success`应为`false`，返回值 **[应该]** 包含`error`对象，`error`对象包含如下属性：
  * `code`: `类型 string`。错误编码
  * `msg`: `类型 string`。错误信息
* `result`: `类型 object`。返回结果信息。

接口文档的返回值 **[建议]** 省略`success`、`error`字段的说明，只用描述`result`中的内容即可。

`error`对象中的`code`和`msg`可以写在每一个接口返回值说明中， **[建议]** 统一单独写在`api/error.md`中。


## 示例

### 获取用户信息

#### 接口说明

获取用户的基本信息。

#### URL

```
//ip:<port>/v1/user
```

#### 参数说明

| 名称 | 类型 | 是否必须 | 默认值 | 描述 |
|---|---|---|---|---|
| token | boolean | 是 | 无 | 加密标识 |
| id | number | 是 | 无 | 用户ID |

#### 返回值示例

```json
{
  "success": true,
  "result": {
    "username": "jnoodle",
    "age": 30,
    "sex": 1,
    "desp": "一个脱离了低级趣味的人",
  }
}
```

#### 返回值说明

| 名称 | 类型 | 描述 |
|---|---|---|---|---|
| username | string | 用户名 |
| age | number | 年龄 |
| sex | number | 性别，0-女；1-男；2-未知 |
| desp | string | 简介 |



















